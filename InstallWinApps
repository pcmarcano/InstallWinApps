Clear-Host

# Get current windows version
#Get-ComputerInfo | Select-Object WindowsVersion, WindowsBuildLabEx
#[System.Environment]::OSVersion.Version
# Get the OS version information
$osVersion = [System.Environment]::OSVersion.Version

# Extract the major version number
$majorVersion = $osVersion.Major
# Extract the build number
$buildVersion = $osVersion.Build

# Output the major version number (optional)
Write-Host "Windows $majorVersion Build $buildVersion"


# Check if winget is installed
function checkWinget {
    if (-not (Get-Command winget -ErrorAction SilentlyContinue)) {
        Write-Output "winget is not installed on this system."
        Write-Output "Please install winget and try again."
        return $false
    }
    return $true
}


# Check if the computer is conected to the internet
function CheckInternetOne {
    # Using Test-Connection to check internet connectivity
    $test = Test-Connection -ComputerName www.google.com -Count 1 -Quiet

    if ($test) {
        return $true
    }
    else {
        return $false
    }
}


function CheckInternetTwo {

    # Using Invoke-WebRequest to check internet connectivity
    try {
        $response = Invoke-WebRequest -Uri http://www.google.com -UseBasicParsing -TimeoutSec 5
        if ($response.StatusCode -eq 200) {
            Write-Host "Connected to the Internet."
            return $true
        }
    }
    catch {
        Write-Host "Not connected to the Internet."
        return $false
    }
}


function menu {
    <#     param (
        OptionalParameters
    ) #>

    # Prompt the user for input
    Write-Host "Please choose an option (1, 2, or 3):"
    Write-Host "1. Uninstall"
    Write-Host "2. Install"
    Write-Host "3. Option 3"
    $choice = Read-Host "Enter your choice"

    <# return $choice #>
    # Process the input
    switch ($choice) {
        "1" {
            <# Write-Host "Uninstall" #>
            uninstall
        }
        "2" {
            <# Write-Host "Install." #>
            install
        }
        "3" {
            <# Write-Host "You chose: patushc" #>
            Other
        }
        default {
            Write-Host "Invalid choice. Please enter a number between 1 and 3."
        }
    }

}



function uninstall {
    <# param (
        OptionalParameters
    ) #>
    Clear-Host
    Write-Host "Uninstall"
    Write-Host "Please choose an option (1, 2, or 3) r: return"
    $choice = Read-Host "Enter your choice"
    switch ($choice) {
        "1" {
            Write-Host "Option 1"
            
        }
        "2" {
            Write-Host "Option 2"
            
        }
        "3" {
            Write-Host "Option 3"
            
        }
        "x" {
            Write-Host "Return"
            Clear-Host
            menu
        }
        default {
            Write-Host "Invalid choice."
            uninstall
        }
    }
}

function install {
    <# param (
        OptionalParameters
    ) #>
    Clear-Host
    Write-Host "Install"
    Write-Host "Please choose an option (1, 2, or 3) r: return"
    $choice = Read-Host "Enter your choice"
    switch ($choice) {
        "1" {
            Write-Host "Option 1"
            
        }
        "2" {
            Write-Host "Option 2"
            
        }
        "3" {
            Write-Host "Option 3"
            
        }
        "x" {
            Write-Host "Return"
            Clear-Host
            menu
        }
        default {
            Write-Host "Invalid choice."
            uninstall
        }
    }
}

function Other {
    <# param (
        OptionalParameters
    ) #>
    Clear-Host

    Write-Host "Please choose an option (1, 2, or 3) r: return"
    $choice = Read-Host "Enter your choice"
    switch ($choice) {
        "1" {
            Write-Host "Option 1"
            
        }
        "2" {
            Write-Host "Option 2"
            
        }
        "3" {
            Write-Host "Option 3"
            
        }
        "x" {
            Write-Host "Return"
            Clear-Host
            menu
        }
        default {
            Write-Host "Invalid choice."
            uninstall
        }
    }
    
}


# ----------------------------------------------------------

$winGet = checkWinget
if ($winGet) {
    Write-Host "WinGet installed"
    $isConnected = CheckInternetOne
    if ([System.Boolean]$isConnected) {
        Write-Host "Connected to the Internet."
        menu
    }
    else {
        Write-Host "Not Connected to the Internet."
        Write-Host "Trying another methord"
        $isConnected = CheckInternetTwo
        
        if ([System.Boolean]$isConnected) {
            Write-Host "Connected to the Internet."
            menu
        }
        else {
            Write-Host "Not Connected to the Internet."
        }
    }
}




# Prompt user for application name
$appName = Read-Host "Enter the name of the application to install"

# Install the application using winget
try {
    winget install --name "$appName" --silent
    Write-Output "Installation of $appName has completed."
} catch {
    Write-Output "An error occurred while trying to install $appName. Please check the application name and try again."
}